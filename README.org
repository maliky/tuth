#+TITLE: Tusis program

* Tusis Application — Quickstart Guide

** Tusis Application Overview

Tusis is a student information and academic management system designed to streamline administrative tasks at the university. It manages student profiles, curricula, courses, registrations, class schedules, financial transactions, and role-based permissions, all through Django's admin interface.

This document summarizes how to run and test the Tusis application in different environments.
** Getting the Code
Clone the repository and enter its directory:
#+BEGIN_SRC bash
git clone <repository-url>
cd tusis
#+END_SRC
** The apps
Here are the different applications you will find in this directory:
| App Name | Description |
|------------+-----------------------------------------------------------|
| Registry | Handles student documents, registrations, and class rosters |
| Spaces | Manages buildings, rooms, and locations |
| Academics | Maintains courses, curricula, colleges, and prerequisites |
| Timetable | Schedules sections, semesters, academic years, and sessions |
| People | Manages user profiles, roles, and permissions |
| Finance | Processes payments, financial records, and scholarships |

** Running Locally without Docker
For a quick local setup using SQLite, run:
#+BEGIN_SRC bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
cp env-test .env
./run.sh -m  # check run.sh -h for documentation or look the source
#+END_SRC
Open http://127.0.0.1:8000 in your browser.


** Development Environment
To make changes :
The repo includes a ~.python-version~ file which instructs *pyenv* to use a
virtual environment named ~tusis~. You can create it with:
#+BEGIN_SRC bash
pyenv virtualenv 3.12.0 tusis
pyenv local tusis
#+END_SRC
If you prefer not to use ~pyenv virtualenv~, replace the file content with a
supported Python version such as ~3.12~.
- Create a new branch from `dev` or switch to the `dev` branch
- Make your changes
If you add Python libraries using `pip install ...`,
 - add them to `requirements-dev.txt`
#+BEGIN_SRC bash  
echo "xyz" > requirements-dev.txt
#+END_SRC
- Run code checks: 
#+BEGIN_SRC python
black app/ && flake8 app/ && mypy app/
#+END_SRC
*** Tests
Install dependencies from `requirements-dev.txt` and `requirements-test.txt` before running tests.
You can run `./run.sh -m` to start a fresh test on the local machine.
In a second terminal populate your DB with a file having this structure:
#+BEGIN_VERBATIM
academic_year: 25-26
semester: 1 
college: CAFS
course_code: AGR
course_no: 121
course_long_code: AGR121-CAFS
course_title: Practicum I
credit_hours: 1
curriculum: Bsc Agriculture
section: 1
location: SAPEC-SAPEC
space: SAPEC
room: SAPEC
faculty: Prof A
weekday: Friday
start_time: 9:00
end_time: 10:00
#+END_VERBATIM
Check the `run.sh` script to see where to put the file.

Before starting the stack, copy the sample environment file:
#+BEGIN_SRC bash
cp .env-dev.example .env-dev
#+END_SRC

*** Launch your docker-compose dev environment
Build and start the dev stack:
#+BEGIN_SRC bash
docker-compose -f docker-compose-dev.yml up --build
#+END_SRC
Once the containers are running, visit [[https://localhost][https://localhost]] to access the app.

*** Running Tests
**** Using Docker

Run tests within the dev container:

#+BEGIN_SRC bash
docker-compose -f docker-compose-dev.yml run --rm web pytest tests/
#+END_SRC

Access the application at [[https://localhost][https://localhost]]

**** Without Docker (Linux)

Load the environment variables from your local `.env` file, then run pytest:

#+BEGIN_SRC bash
export $(grep -v '^#' .env | xargs)  # load variables
pytest tests/
#+END_SRC

**** Browser UI smoke tests
The Selenium suite exercises the public landing page and any future UI flows that require a real browser. Install the dev requirements, then run:
#+BEGIN_SRC bash
pytest -m selenium tests/selenium
#+END_SRC
By default the tests spin up a headless Chrome instance via =webdriver-manager=. You can tweak the driver with environment variables:
- ~SELENIUM_BROWSER~: `chrome` (default) or `firefox`
- ~SELENIUM_HEADLESS~: set to `0` to watch the browser
- ~SELENIUM_IMPLICIT_WAIT~: seconds to wait for DOM queries
example:
#+BEGIN_SRC bash
docker run -d --rm -p 4444:4444 -p 7900:7900 selenium/standalone-chrome:126.0
SELENIUM_REMOTE_URL=http://127.0.0.1:4444/wd/hub pytest -m selenium tests/selenium
#+END_SRC
When the variable is set the suite connects to the remote browser instead of starting a local one.
If the runtime disallows opening localhost sockets (some secure sandboxes do), the tests will be auto-skipped with a clear reason.

*** Restart from a clean state
#+BEGIN_SRC bash term2
  docker-compose -f docker-compose-dev.yml down -v
  sudo rm app/migrations/*
#+END_SRC

In another terminal,
#+BEGIN_SRC bash term2
   docker-compose -f docker-compose-dev.yml up --build
#+END_SRC

#+BEGIN_SRC bash  term3
    docker-compose -f docker-compose-dev.yml exec web python manage.py makemigrations app
    docker-compose -f docker-compose-dev.yml exec web python manage.py migrate
    docker-compose -f docker-compose-dev.yml exec web python manage.py populate_initial_data
#+END_SRC

*** Passwords
** Production Environment

Build and launch the production environment:

# Copy the sample production environment settings:
#+BEGIN_SRC bash
cp .env-prod.example .env-prod
#+END_SRC

#+begin_src bash
docker-compose -f docker-compose-prod.yml up --build -d
#+end_src

- Ensure that your production `.env-prod` file is configured and secure.

Access the application via your production URL (e.g., [[https://tuth.koba.sarl][https://tusis.koba.sarl]]).

** Data Import/Export

Several admin screens expose Import and Export buttons powered by
the =django-import-export= package. Use these buttons to upload CSV
or XLSX files and to download existing records. Models such as
Courses, Curricula and Sections already provide corresponding
resources.


** Importing a full workbook
Use ``import_workbook`` to load an Excel file containing
``timetable``, ``academics``, ``people`` and ``spaces`` sheets.

# +begin_src bash
python manage.py import_workbook myfile.xlsx --dry-run
# +end_src
Run the command without ``--dry-run`` to persist changes.

* COMMENT
Installing nodes
Installing pyenv
Installing python 3.13
#+BEGIN_SRC bash  -i
pyenv install 3.13
pyenv virtualenv 3.13 tusis
pyenv local tusis
#+END_SRC
Installing librairies
** special lib

*** pygraphviz
#+BEGIN_SRC bash  -i
sudo apt-get install graphviz graphviz-dev
pip install pygraphviz
#+END_SRC

pip install -r requirements-dev

Installing webdriver
Installing DB posgresql
Installing IDE / codex


*  Tusis Web Design Guide
** Overview
*** Legacy Critique & Modernization
 The legacy TU marketing pages deliver a bold identity yet ship heavy DOM trees, large hero imagery, and overlapping JS plugins. On low bandwidth this causes late first paint, layout shift, and inaccessible interactions (multi-level hover menus without keyboard support, insufficient focus states, low-contrast hover colors). The situation is amplified because most visitors arrive on smartphones with modest CPUs and limited data packages. This guide keeps the recognizable palette and component vocabulary but reworks each element to be accessible-first, mobile-first, performant on slow networks, and easier to maintain inside Tusis.
*** Purpose
 This guide distills the visual language used across the public Tubman University pages that power Tusis. Use it to ensure every new screen inherits the same character: bold institutional branding, information-dense layouts, and mobile-ready behaviors.

*** Audience
 - Designers translating wireframes into high-fidelity comps
 - Frontend engineers implementing templates in Django/Bootstrap
 - Content editors evaluating whether a new block matches the system

*** Source Material
 Patterns documented here are reverse-engineered from the live TU marketing pages (top header, mega navigation, hero carousel, Swiper-driven news slider, card grids, tabular directory, contact map, and footer).

** Design Pillars
 1. *Heritage First* – foreground TU’s deep green (#134529) and phoenix gold (#ffc107) while preserving WCAG AA contrast and legible hover states.
 2. *Mobile First Access* – design layouts, breakpoints, and assets so the smartphone experience (portrait ≤576 px) is primary; scale up gracefully to tablets/desktops.
 3. *Information Density With Order* – welcome long tables and narratives but enforce consistent spacing, progressive disclosure, and typographic rhythm to reduce cognitive load.
 4. *Motion With Restraint* – limit animation to meaningful cues (carousels, Swiper, counters, scrollCue) and respect =prefers-reduced-motion=.
 5. *Device Parity* – ensure the off-canvas mobile experience exposes identical navigation depth as desktop mega menus.
 6. *Bandwidth Respect* – keep critical CSS/JS under 200 KB compressed, lazy-load media, and defer optional libraries until needed.
 7. *Accessibility First* – semantic HTML, keyboard focus rings, ARIA labeling, and skip links are mandatory.

** Brand Tokens
*** Logo Usage                                                       :ATTACH:
    :PROPERTIES:
    :ID:       73aff189-9eb4-4a1d-9f61-f435d629c007
    :END:
 - Default lockup: use the redesigned TU crest stored with this guide (=ID=73aff189…=). Provide SVG + PNG (512 px square) variants to ensure crisp scaling.
 - Size limits: header max-height =64px= on desktop (=56px= tablet), responsive drawer icon =100px= square, footer lockup =80px=.
 - Maintain ≥16px clear space on all sides and avoid drop shadows or background panels.

*** Color Palette
 | Role                     | Hex      | Usage                                                                 |
 |--------------------------+----------+-----------------------------------------------------------------------|
 | Primary Evergreen        | #134529  | Header backgrounds, CTA icons, counters, carousel controls            |
 | Phoenix Gold Accent      | #ffc107  | Footer background, hover states, badges, CTA underline on hover       |
 | Alert Crimson            | #cc0000  | “TU Portals” button, destructive emphasis                             |
 | Warm Neutral 100         | #f8f9fa  | Section backgrounds, card fill                                        |
 | Cool Gray 400            | #ced4da  | Borders for tables, cards, PDF embed frames                           |
 | Rich Black               | #000000  | Carousel captions, nav text on white backgrounds                      |
 | Pure White               | #ffffff  | Topography contrast, cards, copy blocks                               |

** Typography
*** Font Stack
 Use highly readable humanist sans fonts to support audiences less accustomed to long-form reading:
 =Inter, "Source Sans 3", "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif=.
 Serve Inter via self-hosted files or Google Fonts with =font-display: swap= to keep text visible on slow networks. Enable font-smoothing for dense tables.

*** Hierarchy
 - H1/Hero: 48–64px on desktop, 32px on tablet; heavy weight 700.
 - H2 section headings: 32px/1.2 line-height, centered for hero sections, left-aligned elsewhere.
 - H3/H4: 18–22px for card titles and micro labels.
 - Body copy: 16px with 1.6 line-height for readability within long paragraphs (see President’s message).
 - Utility text (top bar, timestamps): 12px uppercase/medium.

*** Text Treatments
   
 - Use =text-transform: uppercase= sparingly (top ribbon labels, mission/vision headings).
 - Justify long-form narratives; keep cards, lists, and nav items left-aligned.
 - Use bold/strong for names and job titles in directories, not colors.

** Layout & Spacing
*** Grid & Containers
 - Global container: =.container-fluid= for full-width stripes; nest =.container= to center 1200px content.
 - Section padding: =padding: 60px 0= standard; hero/counters use 75px bottom padding.
 - Column layout: rely on Bootstrap’s 12-column grid (e.g., =col-lg-6= for split hero, =col-xl-6= for events list).

*** Spacing Rules
 - Vertical rhythm: 30px between stacked headings and text blocks.
 - Card padding: 15px internal padding, 8px radius, =box-shadow: 0 2px 10px rgba(0,0,0,0.1)=.
 - Funfact counters: zero gutter rows (=row g-0=) to create seamless tiles.

** Navigational Components
*** Top Header Ribbon
 - Background: #134529 with 10px vertical padding.
 - Layout: three columns (logo, “Rising Phoenix” links, portals dropdown).
 - Micro copy uses 10–12px uppercase text with 350 weight; links remain white with underline on hover.
 - TU Portals dropdown: red button with absolute dropdown panel (min-width 160px) and =z-index:20=.

*** Primary Navbar
 - Use Bootstrap =navbar-expand-lg= with =justify-content-center=.
 - Dropdown depth: allow multi-level menus (up to two nested =.dropdown-menu=). Provide hover underline (#ffc107) and keep text dark (#000) on white.
 - Mobile: reuse off-canvas component (#navbarOffcanvas) with evergreen background, accordion-style nested lists, close icon from RemixIcon.

** Hero & Media
*** Carousel
 - Implement Bootstrap carousel (#carouselExampleControls) with 3 slides.
 - Imagery: 70vh height, =object-fit: cover=.
 - Captions: overlay with semi-transparent black (#00000080), 10px padding, 10px radius.
 - Controls: default icons with white fill; set =.carousel-control-prev/next= to show on hover for desktop, always visible on mobile.

*** Video/PDF Embeds
 - Use the =pdf-container= helper (56.25% padding-bottom) for responsive embeds.
 - Keep border radius 0 and hide overflow.

** Content Blocks
*** About Section
 - Two-column layout with image left, copy right for desktop; stack on mobile.
 - Include title block (small uppercase label + main heading) and justify paragraphs.
 - “Read More” arrow CTA uses =.arrow-btn= with icon from Flaticon.

*** Mission/Funfact Tiles
 - Three columns, alternating brand backgrounds (#134529) and white.
 - Flex center icons + text; each tile uses unified padding (30px) and =i= icons from Flaticon.

*** Upcoming Events / Announcements
 - Left column: event highlight with background fill (#134529) and countdown digits (big-text, uppercase labels).
 - Right column: stacked =.upcoming-content-info= rows containing image (96x96), status badge (“Ended”), title link, metadata list (date + location).
 - Countdown logic: vanilla JS interval decreasing =totalSeconds=.

*** Counters
 - Four columns using =.single-counter-info d-flex=.
 - Icons left, numeric value right; use data attributes or =.counter= class for JS increment.

*** Swiper “Latest News”
 - Initialize Swiper with =slidesPerView= breakpoints (1/2/3/4).
 - Provide =.single-blog-card= markup with image, badge (absolute top-left), title, meta list.
 - Override Swiper nav colors to #134529 and use brand bullet for pagination.

*** Data Table (Directory)
 - Include =table-striped table-bordered table-hover table-checkable order-column= classes.
 - Wrap in responsive div (=overflow-x: auto=).
 - Use DataTables plugin with =#example4= ID for pagination/search.
 - Constrain long cells with =max-width= + ellipsis.

*** Contact Section
 - Split layout: form (8 cols) plus contact cards (4 cols).
 - Use =.default-btn= with arrow icon; checkbox baseline for GDPR acknowledgement.
 - Map: embed Google Maps iframe with container-level padding.

*** Footer & Copyright
 - Footer background #ffc107 with 100px top padding; includes About, Academics, Quick Links, Contact.
 - Icons via Flaticon; social links displayed inline.
 - Copyright bar #134529; list of portals aligned right; replicate “Rising Phoenix Corner” copy centered.
 - Back-to-top button fixed bottom-right (#134529).

** Interactivity & Motion
*** Libraries
 - Bootstrap 5 bundle (via CDN) for components/offcanvas.
 - Swiper 11 for sliders; configure autoplay 3s, loop true.
 - scrollCue for subtle scroll-in animations (=data-cues="slideInUp"=).
 - DataTables, Flatpickr, Summernote for admin/data-rich pages.
 - Feather icons, Font Awesome, RemixIcon for iconography.

*** Behaviors
 - Dropdown toggles rely on =data-bs-toggle="offcanvas"= or nested dropdown toggles; ensure =href="javascript:void(0)"= when no real link.
 - Countdown timer uses =setInterval=; clamp at zero.
 - Back-to-top button toggles based on scroll (handled in =app.js=).

** Forms & Inputs
 - Use Bootstrap form controls with border radius 4px, 14px padding.
 - Validate at HTML level (required attributes) and show errors in-line below inputs.
 - Contact form CTA uses =.default-btn border-0= with right-arrow icon.
 - For DataTables download link, pair anchor with =download= attribute for XLSX.

** Accessibility
 - Maintain contrast ratio > 4.5:1 (white text on #134529 or #cc0000, black text on #ffc107 for headings only—pair with bold weight).
 - All links require =text-decoration= on hover; top bar links stay underlined.
 - Provide =aria-label= for carousel controls, dropdown toggles, and back-to-top button.
 - Use semantic headings order; avoid skipping levels inside cards.

** Responsive Rules
 The smartphone portrait experience (≤576 px) is the baseline. Design, test, and QA every component on touch devices with limited bandwidth before scaling up.
 - Breakpoints:
   - ≤768px: reduce carousel height to 50vh, shrink captions (18px/14px).
   - ≤576px: stack header ribbon items, convert nav into off-canvas menu, set Swiper =slidesPerView=1.
 - Ensure dropdown menus become accordion lists inside responsive navbar (toggle classes replicated via =responsive-menu-list=).

** Utilities & Helpers
 - =.burger-menu= spans (top/middle/bottom) animate for navbar toggler.
 - =.badges= (news cards) vs Bootstrap =.badge=: use custom absolute placement (top:10px, left:10px).
 - =.pdf-container= for responsive document embeds.
 - Shadow/hover: cards translate Y -5px on hover; transitions 0.3s ease.

** Implementation Checklist
 1. Load critical CSS only (Bootstrap + site stylesheet + icon font) in =<head>=; lazy-load Swiper/scrollCue styles with =media="print" onload= when not immediately required.
 2. Concatenate essential JS into one deferred bundle (Bootstrap + site scripts). Dynamically import Swiper, counters, or scrollCue only on pages that instantiate them. Retire legacy scripts (hide.js/app.js/layout.js/theme-color.js/drop.js/caro.js) unless refactored into the new bundle.
 3. Register optional plugins (Flatpickr, Summernote, DataTables) per page via dynamic import to keep baseline payload minimal for low-connectivity users.
 4. When adding a new section, match padding, background, and heading treatments from existing sections before introducing new variations.
 5. Test both the desktop mega-nav and the off-canvas nav for parity.

** References
 - Bootstrap v5.3.3 documentation for component behavior
 - Swiper.js v11 API for advanced slider interactions
 - DataTables + Bootstrap 5 integration guide
 - TU icon library: Flaticon + RemixIcon CDN bundles listed above
